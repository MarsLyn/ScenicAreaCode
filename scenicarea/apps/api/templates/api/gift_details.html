{% extends 'api/index.html' %}
{% load static %}

{% block title %}我的礼物{% endblock %}

{% block header %}
<div class="row" style="background-color: #21A936; color: #ffffff;">
  <div class="col-12 py-3 text-center">
    <h3 class="mb-0">{% block h_title %}我的礼物{% endblock %}</h3>
  </div>
</div>


{% block search %}

{% endblock %}

{% endblock %}

{% block main %}
<div class="card mt-3" style="max-width: 540px;">
    <div class="row g-0">
        <div class="col-12" style="height: 388px;">
            <img src="{{giftrelation.gift.commodity.picture.url}}" class="object-fit-cover card-img-top" alt="..." style="height: 100%; width: 100%;">
        </div>
    </div>
    <div class="row g-0">
        <div class="col-12">
        <div class="card-body g-3">
            <div class="row align-items-center">
                <div class="col-auto">
                    <small class="text-muted">状态：</small>
                </div>
                <div class="col-auto ms-auto">
                    <p class="fs-5 mb-0 card-text" style="color: #21A936;">{{giftrelation.status.name}}</p>
                </div>
            </div>
            <div class="row align-items-center">
                <div class="col-auto">
                    <small class="text-muted">标题：</small>
                </div>
                <div class="col-auto ms-auto">
                    <p class="card-text fs-5 mb-0">{{giftrelation.gift.commodity.title}}</p>
                </div>
            </div>
            <div class="row align-items-center">
                <div class="col-auto">
                    <small class="text-muted">价格：</small>
                </div>
                <div class="col-auto ms-auto">
                    <p class="card-text fs-5 mb-0">{{giftrelation.gift.commodity.price}}</p>
                </div>
            </div>
            <div class="row align-items-center">
                <div class="col-auto">
                    <small class="text-muted">更新时间：</small>
                </div>
                <div class="col-auto ms-auto">
                    <p class="card-text fs-5 mb-0">{{giftrelation.update_date}}</p>
                </div>
            </div>
            

            {% if giftrelation.receive_user == request.user %}
                <div class="row align-items-center">
                    <div class="col-auto">
                        <small class="text-muted">赠送人：</small>
                    </div>
                    <div class="col-auto ms-auto">
                        <p class="card-text fs-5 mb-0">{{giftrelation.gift_user.username}}</p>
                    </div>
                </div>
                <div class="row py-3 justify-content-center">
                    <div class="col-auto">
                        {% if giftrelation.status.id == 1 or giftrelation.status.id == 3%}
                            <form action="{% url 'api:gift_receive' giftrelation.gift.id%}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-info text-light" style="--bs-btn-padding-x: 9rem; --bs-btn-padding-y: 1rem;">接收礼物</button>
                            </form>
                        {% else %}
                            {% if not giftrelation.forward %}
                                <a href="{% url 'api:forward_gift' giftrelation.gift.id  giftrelation.gift.commodity.id %}" class="btn btn-primary" style="--bs-btn-padding-x: 9rem; --bs-btn-padding-y: 1rem;">转发礼物</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <div class="row align-items-center">
                    <div class="col-auto">
                        <small class="text-muted">接收人：</small>
                    </div>
                    <div class="col-auto ms-auto">
                        <p class="card-text fs-5 mb-0">{{giftrelation.receive_user.username}}</p>
                    </div>
                </div>
            {% endif %}
        </div>
        </div>
    </div>
</div>
{% endblock %}